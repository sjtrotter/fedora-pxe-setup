function load_video {
    insmod efi_gop
    insmod efi_uga
    insmod video_bochs
    insmod video_cirrus
    insmod all_video
}

load_video
set gfxpayload=keep
insmod gzio

menuentry 'Exit this grub' {
    exit
}

{% for ks in kickstart.files %}
menuentry 'Manual Install - Fedora {{ version }}'  --class fedora --class gnu-linux --class gnu --class os {
    linuxefi (http,{{ ansible_default_ipv4.address }})/{{ (ks.path | replace('/var/www/html/','')).split('ks')[0] }}/images/pxeboot/vmlinuz ip=dhcp inst.repo=http://{{ ansible_default_ipv4.address }}/{{ ks.path | replace('/var/www/html/','') }}/
    initrd (http,{{ ansible_default_ipv4.address }})/{{ ks.path | replace('/var/www/html/','') }}/images/pxeboot/initrd.img
}

menuentry 'AutoInstall - Basic Fedora {{ version }} Workstation' --class fedora --class gnu-linux --class gnu --class os {
    linuxefi (http,{{ ansible_default_ipv4.address }})/{{ ks.path | replace('/var/www/html/','') }}/images/pxeboot/vmlinuz ip=dhcp inst.repo=http://{{ ansible_default_ipv4.address }}/{{ ks.path | replace('/var/www/html/','') }}/ inst.ks=http://{{ansible_default_ipv4.address}}/{{ ks.path | replace('/var/www/html/','') }}/ks/basic-workstation.ks
    initrd (http,{{ ansible_default_ipv4.address }})/{{ ks.path | replace('/var/www/html/','') }}/images/pxeboot/initrd.img
}

{% endfor %}